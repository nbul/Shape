

Coordinates = [(radius.*cosd(X:X:360))', (radius.*sind(X:X:360))'];

Coordinates = [Coordinates(end-1,:); Coordinates(end,:); Coordinates; Coordinates(1,:); Coordinates(2,:)];


 for i=2:(length(Coordinates)-1)
     x1 = Coordinates(i-1,1);
     x2 = Coordinates(i,1);
     x3 = Coordinates(i+1,1);
     y1 = Coordinates(i-1,2);
     y2 = Coordinates(i,2);
     y3 = Coordinates(i+1,2);
     K(i-1) = 2*abs((x2-x1).*(y3-y1)-(x3-x1).*(y2-y1)) ./ ...
     sqrt(((x2-x1).^2+(y2-y1).^2)*((x3-x1).^2+(y3-y1).^2)*((x3-x2).^2+(y3-y2).^2));
 end

xe = [Coordinates(3,1);Coordinates(:,1);Coordinates(end-2,1)]; 
ye = [Coordinates(3,2);Coordinates(:,2);Coordinates(end-2,2)];
dx = diff(xe); dy = diff(ye);
dxb = dx(1:end-1); dyb = dy(1:end-1);
dxf = dx(2:end); dyf = dy(2:end);
d2x = xe(3:end)-xe(1:end-2); d2y = ye(3:end)-ye(1:end-2);
curv = abs(2*(dxb.*dyf-dyb.*dxf)./ ...
       sqrt((dxb.^2+dyb.^2).*(dxf.^2+dyf.^2).*(d2x.^2+d2y.^2)));
   
A = [Coordinates(:,1).^2+y.^2,x,y,ones(size(x))]; % Set up least squares problem
 [U,S,V] = svd(A,0); % Use economy version sing. value decompos.
 a = V(1,4); b = V(2,4); % Choose eigenvector from V
 c = V(3,4); d = V(4,4); % with smallest eigenvalue
 xc = -b/(2*a); yc = -c/(2*a); % Find center and radius of the
 r = sqrt(xc^2+yc^2-d/a); % circle, a*(x^2+y^2)+b*x+c*y+d=0
